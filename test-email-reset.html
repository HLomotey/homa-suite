<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Email Reset Test</title>
    <link rel="icon" type="image/png" href="/Compass.png" />
    <link rel="shortcut icon" type="image/png" href="/Compass.png" />
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
</head>
<body>
    <h1>Supabase Email Reset Test</h1>
    <input type="email" id="email" placeholder="Enter email" />
    <button onclick="testReset()">Test Reset</button>
    <div id="result"></div>

    <script>
        // Using your project's credentials
        const supabaseUrl = 'https://vconsodaevbqavtijaby.supabase.co';
        // You need to replace this with your actual Supabase anonymous key
        // Get it from: https://supabase.com/dashboard/project/vconsodaevbqavtijaby/settings/api
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZjb25zb2RhZXZicWF2dGlqYWJ5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTMyODg4OTYsImV4cCI6MjA2ODg2NDg5Nn0.Wg4Ho8xu_08Y-getSUZ0j5Nbpg4QJuue9Vka-gpZGd8';
        
        if (!supabaseKey || supabaseKey.includes('eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZjb25zb2RhZXZicWF2dGlqYWJ5Iiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1MzI4ODg5NiwiZXhwIjoyMDY4ODY0ODk2fQ.0VZ8BPzPct_Ge8uAWhbZtdpJQNcAKePnI6fznHW2_Yk')) {
            document.getElementById('result').innerHTML = '<p style="color: red;">Error: Please replace the supabaseKey with your actual Supabase anonymous key from the dashboard.</p>';
            return;
        }
        
        const supabase = window.supabase.createClient(supabaseUrl, supabaseKey);

        async function testReset() {
            const email = document.getElementById('email').value;
            const result = document.getElementById('result');
            
            if (!email) {
                result.innerHTML = '<p style="color: red;">Please enter an email</p>';
                return;
            }

            result.innerHTML = '<p>Sending...</p>';

            try {
                const { data, error } = await supabase.auth.resetPasswordForEmail(email, {
                    redirectTo: 'http://localhost:8080/reset-password'
                });

                if (error) {
                    result.innerHTML = `<p style="color: red;">Error: ${error.message}</p>
                                      <pre>${JSON.stringify(error, null, 2)}</pre>`;
                } else {
                    result.innerHTML = `<p style="color: green;">Success! Check your email.</p>
                                      <pre>${JSON.stringify(data, null, 2)}</pre>`;
                }
            } catch (err) {
                result.innerHTML = `<p style="color: red;">Exception: ${err.message}</p>
                                  <pre>${JSON.stringify(err, null, 2)}</pre>`;
            }
        }
    </script>
</body>
</html>
